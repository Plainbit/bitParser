
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Summary Analysis Report (CloudTrail Log)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        .section {
            padding: 30px;
            border-bottom: 1px solid #eee;
        }
        .section:last-child {
            border-bottom: none;
        }
        .section h2 {
            color: #2c3e50;
            margin: 0 0 20px 0;
            font-size: 1.8em;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #3498db;
        }
        .stat-card h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 1.2em;
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
            margin: 10px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        th {
            background: #34495e;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        tr:hover {
            background: #e3f2fd;
        }
        .chart-container {
            margin: 20px 0;
            text-align: center;
        }
        .no-data {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 40px;
        }
        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 0.9em;
        }
        .chart-container {
            margin: 20px 0;
            height: 400px;
            position: relative;
        }
        .chart-wrapper {
            width: 100%;
            height: 400px;
            margin: 20px 0;
            background: #fafafa;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Summary Analysis Report (CloudTrail Log)</h1>
            <p>Generated on 2025-10-21 12:47:33</p>
        </div>
        
        
        <div class="section">
            <h2>1. Access IP Statistics (Top 20)</h2>
            <div class="chart-wrapper">
                <canvas id="topIpsChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>IP Address</th>
                        <th>First Access (UTC+0)</th>
                        <th>First Access (Local)</th>
                        <th>Last Access (UTC+0)</th>
                        <th>Last Access (Local)</th>
                        <th>Access Count</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>222.99.52.250</td>
                <td>2025-10-01 10:29:42</td>
                <td>2025-10-01 05:29:42</td>
                <td>2025-10-02 04:57:15</td>
                <td>2025-10-02 13:57:15</td>
                <td>1569</td>
            </tr>
            
            <tr>
                <td>cloudtrail.amazonaws.com</td>
                <td>2025-10-01 10:31:10</td>
                <td>2025-10-01 05:31:25</td>
                <td>2025-10-02 04:56:42</td>
                <td>2025-10-02 14:33:11</td>
                <td>1291</td>
            </tr>
            
            <tr>
                <td>delivery.logs.amazonaws.com</td>
                <td>2025-10-01 10:35:34</td>
                <td>2025-10-01 19:35:34</td>
                <td>2025-10-02 04:53:36</td>
                <td>2025-10-02 13:53:36</td>
                <td>573</td>
            </tr>
            
            <tr>
                <td>config.amazonaws.com</td>
                <td>2025-10-01 10:29:19</td>
                <td>2025-10-01 05:29:19</td>
                <td>2025-10-02 04:46:59</td>
                <td>2025-10-02 05:46:59</td>
                <td>524</td>
            </tr>
            
            <tr>
                <td>s3.amazonaws.com</td>
                <td>2025-10-01 11:14:20</td>
                <td>2025-10-01 20:14:20</td>
                <td>2025-10-01 14:43:16</td>
                <td>2025-10-01 23:43:16</td>
                <td>69</td>
            </tr>
            
            <tr>
                <td>85.203.21.51</td>
                <td>2025-10-01 11:30:38</td>
                <td>2025-10-01 06:30:38</td>
                <td>2025-10-01 12:17:36</td>
                <td>2025-10-01 21:17:36</td>
                <td>45</td>
            </tr>
            
            <tr>
                <td>85.203.21.26</td>
                <td>2025-10-01 11:35:31</td>
                <td>2025-10-01 06:35:31</td>
                <td>2025-10-01 12:30:26</td>
                <td>2025-10-01 21:30:26</td>
                <td>44</td>
            </tr>
            
            <tr>
                <td>85.203.21.9</td>
                <td>2025-10-01 11:34:04</td>
                <td>2025-10-01 06:34:04</td>
                <td>2025-10-01 12:28:19</td>
                <td>2025-10-01 21:28:19</td>
                <td>43</td>
            </tr>
            
            <tr>
                <td>AWS Internal</td>
                <td>2025-10-01 10:35:34</td>
                <td>2025-10-01 19:35:34</td>
                <td>2025-10-02 04:23:37</td>
                <td>2025-10-02 13:23:37</td>
                <td>39</td>
            </tr>
            
            <tr>
                <td>85.203.21.49</td>
                <td>2025-10-01 11:34:02</td>
                <td>2025-10-01 06:34:02</td>
                <td>2025-10-02 04:31:37</td>
                <td>2025-10-01 23:31:37</td>
                <td>33</td>
            </tr>
            
            <tr>
                <td>85.203.21.47</td>
                <td>2025-10-01 11:41:37</td>
                <td>2025-10-01 20:42:36</td>
                <td>2025-10-02 04:36:43</td>
                <td>2025-10-02 13:36:43</td>
                <td>32</td>
            </tr>
            
            <tr>
                <td>85.203.21.68</td>
                <td>2025-10-01 11:30:38</td>
                <td>2025-10-01 06:30:38</td>
                <td>2025-10-01 12:17:06</td>
                <td>2025-10-01 21:03:14</td>
                <td>32</td>
            </tr>
            
            <tr>
                <td>85.203.21.25</td>
                <td>2025-10-01 11:41:37</td>
                <td>2025-10-01 06:48:24</td>
                <td>2025-10-02 04:32:51</td>
                <td>2025-10-02 13:32:51</td>
                <td>31</td>
            </tr>
            
            <tr>
                <td>85.203.21.44</td>
                <td>2025-10-01 12:05:29</td>
                <td>2025-10-01 07:16:54</td>
                <td>2025-10-02 04:38:07</td>
                <td>2025-10-02 13:38:07</td>
                <td>29</td>
            </tr>
            
            <tr>
                <td>85.203.21.53</td>
                <td>2025-10-01 11:43:37</td>
                <td>2025-10-01 06:58:54</td>
                <td>2025-10-02 04:32:52</td>
                <td>2025-10-02 14:31:00</td>
                <td>28</td>
            </tr>
            
            <tr>
                <td>85.203.21.46</td>
                <td>2025-10-01 11:40:42</td>
                <td>2025-10-01 20:58:54</td>
                <td>2025-10-01 12:02:51</td>
                <td>2025-10-01 21:41:36</td>
                <td>23</td>
            </tr>
            
            <tr>
                <td>85.203.21.38</td>
                <td>2025-10-01 11:34:04</td>
                <td>2025-10-01 06:34:04</td>
                <td>2025-10-01 12:03:14</td>
                <td>2025-10-01 21:03:14</td>
                <td>22</td>
            </tr>
            
            <tr>
                <td>85.203.21.42</td>
                <td>2025-10-01 11:30:30</td>
                <td>2025-10-01 20:30:30</td>
                <td>2025-10-02 04:31:38</td>
                <td>2025-10-02 13:31:38</td>
                <td>20</td>
            </tr>
            
            <tr>
                <td>vpc-flow-logs.amazonaws.com</td>
                <td>2025-10-01 10:50:32</td>
                <td>2025-10-01 19:50:32</td>
                <td>2025-10-02 04:37:37</td>
                <td>2025-10-02 13:37:37</td>
                <td>20</td>
            </tr>
            
            <tr>
                <td>85.203.21.24</td>
                <td>2025-10-01 11:30:11</td>
                <td>2025-10-01 06:30:11</td>
                <td>2025-10-02 04:31:37</td>
                <td>2025-10-02 13:31:37</td>
                <td>18</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const topIpsCtx = document.getElementById('topIpsChart').getContext('2d');
                new Chart(topIpsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['222.99.52.250', 'cloudtrail.amazonaws.com', 'delivery.logs.amazonaws.com', 'config.amazonaws.com', 's3.amazonaws.com', '85.203.21.51', '85.203.21.26', '85.203.21.9', 'AWS Internal', '85.203.21.49'],
                        datasets: [{
                            data: [1569, 1291, 573, 524, 69, 45, 44, 43, 39, 33],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(155, 89, 182, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(26, 188, 156, 0.8)',
                                'rgba(142, 68, 173, 0.8)',
                                'rgba(39, 174, 96, 0.8)',
                                'rgba(41, 128, 185, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Top 10 IPs by Access Count'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="section">
            <h2>2. Nightshift(22:00-06:00) IP Statistics</h2>
            <div class="chart-wrapper">
                <canvas id="nightshiftIpsChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>IP Address</th>
                        <th>Access Count</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>cloudtrail.amazonaws.com</td>
                <td>496</td>
            </tr>
            
            <tr>
                <td>delivery.logs.amazonaws.com</td>
                <td>245</td>
            </tr>
            
            <tr>
                <td>config.amazonaws.com</td>
                <td>233</td>
            </tr>
            
            <tr>
                <td>222.99.52.250</td>
                <td>140</td>
            </tr>
            
            <tr>
                <td>s3.amazonaws.com</td>
                <td>47</td>
            </tr>
            
            <tr>
                <td>securityhub.amazonaws.com</td>
                <td>9</td>
            </tr>
            
            <tr>
                <td>85.203.21.27</td>
                <td>9</td>
            </tr>
            
            <tr>
                <td>vpc-flow-logs.amazonaws.com</td>
                <td>8</td>
            </tr>
            
            <tr>
                <td>85.203.21.43</td>
                <td>7</td>
            </tr>
            
            <tr>
                <td>85.203.21.21</td>
                <td>7</td>
            </tr>
            
            <tr>
                <td>85.203.21.63</td>
                <td>4</td>
            </tr>
            
            <tr>
                <td>85.203.21.49</td>
                <td>2</td>
            </tr>
            
            <tr>
                <td>85.203.21.69</td>
                <td>1</td>
            </tr>
            
            <tr>
                <td>85.203.21.37</td>
                <td>1</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const nightshiftIpsCtx = document.getElementById('nightshiftIpsChart').getContext('2d');
                new Chart(nightshiftIpsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['cloudtrail.amazonaws.com', 'delivery.logs.amazonaws.com', 'config.amazonaws.com', '222.99.52.250', 's3.amazonaws.com', 'securityhub.amazonaws.com', '85.203.21.27', 'vpc-flow-logs.amazonaws.com', '85.203.21.43', '85.203.21.21'],
                        datasets: [{
                            data: [496, 245, 233, 140, 47, 9, 9, 8, 7, 7],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(155, 89, 182, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(26, 188, 156, 0.8)',
                                'rgba(142, 68, 173, 0.8)',
                                'rgba(39, 174, 96, 0.8)',
                                'rgba(41, 128, 185, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Top 10 Nightshift IPs by Access Count'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="section">
            <h2>2. Nightshift EventName Statistics (Top 20)</h2>
            <div class="chart-wrapper">
                <canvas id="nightshiftEventsChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Event Name</th>
                        <th>Nightshift Event Count</th>
                        <th>Event Statistics (%)</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>PutObject</td>
                <td>628</td>
                <td>39.77%</td>
            </tr>
            
            <tr>
                <td>GetBucketAcl</td>
                <td>170</td>
                <td>10.77%</td>
            </tr>
            
            <tr>
                <td>AssumeRole</td>
                <td>114</td>
                <td>7.22%</td>
            </tr>
            
            <tr>
                <td>ListManagedNotificationEvents</td>
                <td>95</td>
                <td>6.02%</td>
            </tr>
            
            <tr>
                <td>HeadBucket</td>
                <td>56</td>
                <td>3.55%</td>
            </tr>
            
            <tr>
                <td>GetAccountPlanState</td>
                <td>51</td>
                <td>3.23%</td>
            </tr>
            
            <tr>
                <td>GetAccountColor</td>
                <td>33</td>
                <td>2.09%</td>
            </tr>
            
            <tr>
                <td>GetFeatureOptInStatus</td>
                <td>33</td>
                <td>2.09%</td>
            </tr>
            
            <tr>
                <td>ListPolicies</td>
                <td>26</td>
                <td>1.65%</td>
            </tr>
            
            <tr>
                <td>ListAccessKeys</td>
                <td>16</td>
                <td>1.01%</td>
            </tr>
            
            <tr>
                <td>ListBuckets</td>
                <td>15</td>
                <td>0.95%</td>
            </tr>
            
            <tr>
                <td>DescribeEventAggregates</td>
                <td>15</td>
                <td>0.95%</td>
            </tr>
            
            <tr>
                <td>ListResources</td>
                <td>15</td>
                <td>0.95%</td>
            </tr>
            
            <tr>
                <td>GetPolicy</td>
                <td>14</td>
                <td>0.89%</td>
            </tr>
            
            <tr>
                <td>DescribeOrganization</td>
                <td>14</td>
                <td>0.89%</td>
            </tr>
            
            <tr>
                <td>GetAccessKeyLastUsed</td>
                <td>13</td>
                <td>0.82%</td>
            </tr>
            
            <tr>
                <td>GetCostAndUsage</td>
                <td>11</td>
                <td>0.7%</td>
            </tr>
            
            <tr>
                <td>DescribeMetricFilters</td>
                <td>11</td>
                <td>0.7%</td>
            </tr>
            
            <tr>
                <td>DescribeEvents</td>
                <td>9</td>
                <td>0.57%</td>
            </tr>
            
            <tr>
                <td>ListGroupsForUser</td>
                <td>9</td>
                <td>0.57%</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const nightshiftEventsCtx = document.getElementById('nightshiftEventsChart').getContext('2d');
                new Chart(nightshiftEventsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['PutObject', 'GetBucketAcl', 'AssumeRole', 'ListManagedNotificationEvents', 'HeadBucket', 'GetAccountPlanState', 'GetAccountColor', 'GetFeatureOptInStatus', 'ListPolicies', 'ListAccessKeys'],
                        datasets: [{
                            data: [628, 170, 114, 95, 56, 51, 33, 33, 26, 16],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(155, 89, 182, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(26, 188, 156, 0.8)',
                                'rgba(142, 68, 173, 0.8)',
                                'rgba(39, 174, 96, 0.8)',
                                'rgba(41, 128, 185, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Top 10 Nightshift Events Distribution'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="section">
            <h2>4. EventName Statistics (Top 20)</h2>
            <div class="chart-wrapper">
                <canvas id="eventNamesChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Event Name</th>
                        <th>Event Count</th>
                        <th>Event Statistics (%)</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>PutObject</td>
                <td>1385</td>
                <td>26.67%</td>
            </tr>
            
            <tr>
                <td>GetBucketAcl</td>
                <td>367</td>
                <td>7.07%</td>
            </tr>
            
            <tr>
                <td>AssumeRole</td>
                <td>272</td>
                <td>5.24%</td>
            </tr>
            
            <tr>
                <td>HeadBucket</td>
                <td>175</td>
                <td>3.37%</td>
            </tr>
            
            <tr>
                <td>ListManagedNotificationEvents</td>
                <td>164</td>
                <td>3.16%</td>
            </tr>
            
            <tr>
                <td>DescribeMetricFilters</td>
                <td>129</td>
                <td>2.48%</td>
            </tr>
            
            <tr>
                <td>DescribeInstanceTypes</td>
                <td>85</td>
                <td>1.64%</td>
            </tr>
            
            <tr>
                <td>ListObjects</td>
                <td>83</td>
                <td>1.6%</td>
            </tr>
            
            <tr>
                <td>DescribeSnapshots</td>
                <td>82</td>
                <td>1.58%</td>
            </tr>
            
            <tr>
                <td>GetAccountPlanState</td>
                <td>69</td>
                <td>1.33%</td>
            </tr>
            
            <tr>
                <td>DescribeInstanceStatus</td>
                <td>63</td>
                <td>1.21%</td>
            </tr>
            
            <tr>
                <td>DescribeInstances</td>
                <td>53</td>
                <td>1.02%</td>
            </tr>
            
            <tr>
                <td>GetObject</td>
                <td>47</td>
                <td>0.91%</td>
            </tr>
            
            <tr>
                <td>DescribeNetworkInterfaces</td>
                <td>46</td>
                <td>0.89%</td>
            </tr>
            
            <tr>
                <td>DescribeAlarms</td>
                <td>46</td>
                <td>0.89%</td>
            </tr>
            
            <tr>
                <td>DescribeAddresses</td>
                <td>45</td>
                <td>0.87%</td>
            </tr>
            
            <tr>
                <td>GetAccountColor</td>
                <td>43</td>
                <td>0.83%</td>
            </tr>
            
            <tr>
                <td>GetFeatureOptInStatus</td>
                <td>43</td>
                <td>0.83%</td>
            </tr>
            
            <tr>
                <td>ListNotificationHubs</td>
                <td>43</td>
                <td>0.83%</td>
            </tr>
            
            <tr>
                <td>DescribeInstanceAttribute</td>
                <td>42</td>
                <td>0.81%</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const eventNamesCtx = document.getElementById('eventNamesChart').getContext('2d');
                new Chart(eventNamesCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['PutObject', 'GetBucketAcl', 'AssumeRole', 'HeadBucket', 'ListManagedNotificationEvents', 'DescribeMetricFilters', 'DescribeInstanceTypes', 'ListObjects', 'DescribeSnapshots', 'GetAccountPlanState'],
                        datasets: [{
                            data: [1385, 367, 272, 175, 164, 129, 85, 83, 82, 69],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(155, 89, 182, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(26, 188, 156, 0.8)',
                                'rgba(142, 68, 173, 0.8)',
                                'rgba(39, 174, 96, 0.8)',
                                'rgba(41, 128, 185, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Top 10 Event Names by Count'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="section">
            <h2>5. UserAgent Statistics</h2>
            <div class="chart-wrapper">
                <canvas id="userAgentsChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>UserAgent Type</th>
                        <th>Usage Count</th>
                        <th>Usage Statistics (%)</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>AWS Service</td>
                <td>2766</td>
                <td>53.26%</td>
            </tr>
            
            <tr>
                <td>Browser (Chrome)</td>
                <td>1973</td>
                <td>37.99%</td>
            </tr>
            
            <tr>
                <td>Unknown/Empty</td>
                <td>323</td>
                <td>6.22%</td>
            </tr>
            
            <tr>
                <td>AWS CLI (Python)</td>
                <td>129</td>
                <td>2.48%</td>
            </tr>
            
            <tr>
                <td>AWS SDK (Go)</td>
                <td>2</td>
                <td>0.04%</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const userAgentsCtx = document.getElementById('userAgentsChart').getContext('2d');
                new Chart(userAgentsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['AWS Service', 'Browser (Chrome)', 'Unknown/Empty', 'AWS CLI (Python)', 'AWS SDK (Go)'],
                        datasets: [{
                            data: [2766, 1973, 323, 129, 2],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(155, 89, 182, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(26, 188, 156, 0.8)',
                                'rgba(142, 68, 173, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'UserAgent Types Distribution'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="section">
            <h2>6. Failed Authentication/Authorization Statistics</h2>
            <table>
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Count</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>Authorization Failures - IPs</td>
                <td>7</td>
                <td>delivery.logs.amazonaws.com (139); 222.99.52.250 (8); config.amazonaws.com (3); 85.203.21.11 (3); 85.203.21.24 (3); cloudtrail.amazonaws.com (1); 85.203.21.13 (1)</td>
            </tr>
            
            <tr>
                <td>Authorization Failures - Users</td>
                <td>2</td>
                <td>access.admin (7); acces.admin (3)</td>
            </tr>
            
                </tbody>
            </table>
        </div>
        
        
        <div class="section">
            <h2>7. Region Statistics</h2>
            <div class="chart-wrapper">
                <canvas id="regionsChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Region</th>
                        <th>Event Count</th>
                        <th>Event Statistics (%)</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>ap-northeast-2</td>
                <td>3678</td>
                <td>70.83%</td>
            </tr>
            
            <tr>
                <td>us-east-1</td>
                <td>629</td>
                <td>12.11%</td>
            </tr>
            
            <tr>
                <td>eu-north-1</td>
                <td>539</td>
                <td>10.38%</td>
            </tr>
            
            <tr>
                <td>ap-southeast-2</td>
                <td>24</td>
                <td>0.46%</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const regionsCtx = document.getElementById('regionsChart').getContext('2d');
                new Chart(regionsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['ap-northeast-2', 'us-east-1', 'eu-north-1', 'ap-southeast-2'],
                        datasets: [{
                            data: [3678, 629, 539, 24],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(155, 89, 182, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(26, 188, 156, 0.8)',
                                'rgba(142, 68, 173, 0.8)',
                                'rgba(39, 174, 96, 0.8)',
                                'rgba(41, 128, 185, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Top 10 Regions by Event Count'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="section">
            <h2>8. ConsoleLogin Statistics (Last 30 Days)</h2>
            <div class="chart-wrapper">
                <canvas id="consoleLoginChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>User</th>
                        <th>Event Time (UTC)</th>
                        <th>Event Time (Local)</th>
                        <th>Source IP</th>
                        <th>Region</th>
                        <th>Login Status</th>
                        <th>User Agent</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>acces.admin</td>
                <td>2025-10-02 04:31:00</td>
                <td>2025-10-02 14:31:00</td>
                <td>85.203.21.53</td>
                <td>ap-southeast-2</td>
                <td>Success</td>
                <td>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36</td>
            </tr>
            
            <tr>
                <td>acces.admin</td>
                <td>2025-10-01 11:40:31</td>
                <td>2025-10-01 21:40:31</td>
                <td>85.203.21.67</td>
                <td>ap-southeast-2</td>
                <td>Success</td>
                <td>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36</td>
            </tr>
            
            <tr>
                <td>access.admin</td>
                <td>2025-10-01 11:30:00</td>
                <td>2025-10-01 21:30:00</td>
                <td>85.203.21.5</td>
                <td>ap-southeast-2</td>
                <td>Success</td>
                <td>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36</td>
            </tr>
            
            <tr>
                <td>access.admin</td>
                <td>2025-10-01 11:25:30</td>
                <td>2025-10-01 12:25:30</td>
                <td>222.99.52.250</td>
                <td>eu-north-1</td>
                <td>Success</td>
                <td>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const consoleLoginCtx = document.getElementById('consoleLoginChart').getContext('2d');
                new Chart(consoleLoginCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Success'],
                        datasets: [{
                            data: [4],
                            backgroundColor: [
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(231, 76, 60, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Login Status Distribution'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="section">
            <h2>9. CreateUser Statistics</h2>
            <div class="chart-wrapper">
                <canvas id="userManagementChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Created User</th>
                        <th>Created By (ARN)</th>
                        <th>Event Time (UTC)</th>
                        <th>Event Time (Local)</th>
                        <th>Source IP</th>
                        <th>Region</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>acces.admin</td>
                <td>arn:aws:iam::231307122651:user/access.admin</td>
                <td>2025-10-01 11:34:02</td>
                <td>2025-10-01 06:34:02</td>
                <td>85.203.21.49</td>
                <td>us-east-1</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const userManagementCtx = document.getElementById('userManagementChart').getContext('2d');
                new Chart(userManagementCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['arn:aws:iam::231307122651:user/access.admin'],
                        datasets: [{
                            data: [1],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(155, 89, 182, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(26, 188, 156, 0.8)',
                                'rgba(142, 68, 173, 0.8)',
                                'rgba(39, 174, 96, 0.8)',
                                'rgba(41, 128, 185, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Top 10 User Creators by ARN'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="section">
            <h2>8. Mitre ATT&CK Tactics Statistics</h2>
            <div class="chart-wrapper">
                <canvas id="mitreAttackChart"></canvas>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Mitre ATT&CK Tactics</th>
                        <th>Event Name</th>
                        <th>Event Name Hit Count</th>
                        <th>Event Statistics (%)</th>
                    </tr>
                </thead>
                <tbody>
                    
            <tr>
                <td>Credential Access</td>
                <td>GetPasswordData</td>
                <td>3</td>
                <td>0.06%</td>
            </tr>
            
            <tr>
                <td>Credential Access</td>
                <td>ListSecrets</td>
                <td>1</td>
                <td>0.02%</td>
            </tr>
            
            <tr>
                <td>Defense Evasion</td>
                <td>DeleteSnapshot</td>
                <td>2</td>
                <td>0.04%</td>
            </tr>
            
            <tr>
                <td>Defense Evasion</td>
                <td>ModifyNetworkInterfaceAttribute</td>
                <td>1</td>
                <td>0.02%</td>
            </tr>
            
            <tr>
                <td>Defense Evasion</td>
                <td>PutEventSelectors</td>
                <td>1</td>
                <td>0.02%</td>
            </tr>
            
            <tr>
                <td>Defense Evasion</td>
                <td>StopLogging</td>
                <td>1</td>
                <td>0.02%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>GetBucketAcl</td>
                <td>367</td>
                <td>7.07%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>ListObjects</td>
                <td>83</td>
                <td>1.6%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>DescribeInstances</td>
                <td>53</td>
                <td>1.02%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>GetBucketVersioning</td>
                <td>29</td>
                <td>0.56%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>HeadObject</td>
                <td>25</td>
                <td>0.48%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>ListBuckets</td>
                <td>21</td>
                <td>0.4%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>ListAccessKeys</td>
                <td>16</td>
                <td>0.31%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>DescribeTrails</td>
                <td>9</td>
                <td>0.17%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>GetBucketPolicy</td>
                <td>5</td>
                <td>0.1%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>ListGroups</td>
                <td>5</td>
                <td>0.1%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>ListUsers</td>
                <td>4</td>
                <td>0.08%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>GetAccountAuthorizationDetails</td>
                <td>3</td>
                <td>0.06%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>GetCallerIdentity</td>
                <td>1</td>
                <td>0.02%</td>
            </tr>
            
            <tr>
                <td>Discovery</td>
                <td>DescribeDBClusters</td>
                <td>1</td>
                <td>0.02%</td>
            </tr>
            
                </tbody>
            </table>
            <script>
                const mitreAttackCtx = document.getElementById('mitreAttackChart').getContext('2d');
                new Chart(mitreAttackCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Impact', 'Discovery', 'Lateral Movement', 'Exfiltration', 'Privilege Escalation', 'Initial Access', 'Defense Evasion', 'Persistence'],
                        datasets: [{
                            data: [1391, 625, 272, 88, 9, 9, 5, 5],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(46, 204, 113, 0.8)',
                                'rgba(155, 89, 182, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(26, 188, 156, 0.8)',
                                'rgba(142, 68, 173, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Top 8 Mitre ATT&CK Tactics Distribution'
                            },
                            legend: {
                                position: 'right'
                            }
                        }
                    }
                });
            </script>
        </div>
        
        
        <div class="footer">
            <p>Summary Analysis Report (CloudTrail Log) - Generated by PLAINBIT Co., LTD.</p>
        </div>
    </div>
</body>
</html>
        